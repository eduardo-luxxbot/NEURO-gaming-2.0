<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHRONOS ECHO - Parte 1: O Despertar [CORRIGIDO]</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        :root {
            --valthoria-blue: #1a237e;
            --valthoria-silver: #c0c0c0;
            --eco-blue: #00bfff;
            --eco-gray: #a0a0a0;
            --fissure-black: #0a0a0f;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; image-rendering: pixelated; }

        body {
            background: #000;
            color: #e0e0e0;
            font-family: 'Press Start 2P', cursive;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-container {
            width: 1024px;
            height: 576px;
            background: #000;
            position: relative;
            box-shadow: 0 0 50px rgba(0, 191, 255, 0.3);
            border: 4px solid var(--valthoria-silver);
            overflow: hidden;
        }

        /* TELA DE T√çTULO */
        #title-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, var(--fissure-black) 0%, #1a1a2e 50%, var(--valthoria-blue) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease-out;
        }

        #title-screen.hidden { 
            opacity: 0; 
            pointer-events: none;
            visibility: hidden;
        }

        .game-title {
            font-size: 48px;
            color: var(--eco-blue);
            text-shadow: 0 0 20px var(--eco-blue), 0 0 40px var(--eco-blue);
            margin-bottom: 20px;
            animation: pulse 3s ease-in-out infinite;
            letter-spacing: 4px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }

        .subtitle { 
            font-size: 14px; 
            color: var(--valthoria-silver); 
            margin-bottom: 40px; 
            text-align: center;
        }

        .menu-option {
            font-size: 12px;
            color: #888;
            margin: 12px 0;
            cursor: pointer;
            transition: all 0.3s;
            padding: 10px 20px;
            border: 2px solid transparent;
            background: transparent;
            font-family: 'Press Start 2P', cursive;
        }

        .menu-option:hover, .menu-option.selected {
            color: var(--eco-blue);
            border-color: var(--eco-blue);
            text-shadow: 0 0 10px var(--eco-blue);
            transform: translateX(10px);
            background: rgba(0,0,0,0.3);
        }

        /* √ÅREA DO JOGO */
        #game-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            background: #000;
        }

        #game-area.active { 
            display: block !important;
            z-index: 100;
        }

        /* CEN√ÅRIOS */
        #scene {
            width: 100%;
            height: 70%;
            position: relative;
            overflow: hidden;
        }

        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: opacity 0.5s;
        }

        .bg-valthoria {
            background: linear-gradient(180deg, #2a2a4a 0%, #1a1a3e 50%, #0f0f1f 100%);
        }

        .bg-valthoria::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent 0px, transparent 80px, rgba(192,192,192,0.1) 80px, rgba(192,192,192,0.1) 100px);
        }

        .throne {
            position: absolute;
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 160px;
            background: radial-gradient(circle at 20% 20%, #4a4a4a 0%, #2a2a2a 30%, transparent 31%),
                        radial-gradient(circle at 80% 20%, #4a4a4a 0%, #2a2a2a 30%, transparent 31%),
                        radial-gradient(circle at 50% 80%, #3a3a3a 0%, #1a1a1a 40%, transparent 41%);
            border: 3px solid #5a5a5a;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
        }

        .throne::after {
            content: 'üëë';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 30px;
            filter: grayscale(100%) brightness(0.7);
        }

        .bg-fissure {
            background: var(--fissure-black);
            position: relative;
        }

        .bg-fissure::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3, #ff0000);
            opacity: 0.1;
            animation: rotate 15s linear infinite;
        }

        @keyframes rotate {
            0% { transform: translate(-25%, -25%) rotate(0deg); }
            100% { transform: translate(-25%, -25%) rotate(360deg); }
        }

        .clock-pile {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40%;
            background: repeating-radial-gradient(circle at 30% 80%, #4a3a2a 0px, #2a1a0a 15px, transparent 16px);
            opacity: 0.6;
        }

        /* PERSONAGENS */
        .character {
            position: absolute;
            transition: all 0.3s;
            cursor: pointer;
            z-index: 50;
        }

        .character:hover { 
            filter: brightness(1.2); 
            transform: scale(1.05);
        }

        /* ECO-ZERO */
        .eco-zero {
            width: 60px;
            height: 100px;
            bottom: 25%;
            left: 50%;
            transform: translateX(-50%);
        }

        .eco-zero-body {
            width: 100%;
            height: 100%;
            background: var(--eco-gray);
            border-radius: 10px 10px 20px 20px;
            position: relative;
            box-shadow: inset -10px 0 20px rgba(0,0,0,0.5), 0 0 20px rgba(0,191,255,0.3);
            animation: glitch 4s infinite;
        }

        @keyframes glitch {
            0%, 90%, 100% { transform: translate(0); }
            91% { transform: translate(-2px, 1px); }
            92% { transform: translate(2px, -1px); }
            93% { transform: translate(0); }
        }

        .eco-zero-head {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: var(--eco-gray);
            border-radius: 50%;
        }

        .eco-zero-eyes {
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 0 5px;
        }

        .eco-eye {
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 10px #fff;
            animation: blink 5s infinite;
        }

        @keyframes blink {
            0%, 48%, 52%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.1); }
        }

        .eco-zero-hair {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 30px;
            background: #f0f0f0;
            border-radius: 50% 50% 0 0;
            clip-path: polygon(20% 100%, 0% 50%, 10% 0%, 30% 30%, 50% 0%, 70% 30%, 90% 0%, 100% 50%, 80% 100%);
        }

        .eco-tears {
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 0 8px;
        }

        .eco-tear {
            width: 3px;
            height: 8px;
            background: #1a1a1a;
            border-radius: 0 0 50% 50%;
            animation: drop 3s infinite;
        }

        @keyframes drop {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(5px); }
        }

        .eco-clock {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: #4a3a2a;
            border: 2px solid #ffd700;
            border-radius: 50%;
        }

        /* REI ALDRIC */
        .aldrich {
            width: 70px;
            height: 110px;
            bottom: 25%;
            left: 50%;
            transform: translateX(-50%);
        }

        .aldrich-body {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #1a237e 0%, #0f0f3e 100%);
            border-radius: 15px;
            position: relative;
            box-shadow: 0 0 30px rgba(26,35,126,0.5);
        }

        .aldrich-head {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 45px;
            height: 50px;
            background: linear-gradient(180deg, #d4a574 0%, #c49464 50%, #8b7355 100%);
            border-radius: 50%;
            overflow: hidden;
        }

        .aldrich-crown {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 25px;
            filter: brightness(1.5);
        }

        .aldrich-eyes {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 0 8px;
        }

        .aldrich-eye {
            width: 8px;
            height: 8px;
            background: #4a90e2;
            border-radius: 50%;
            box-shadow: 0 0 5px #4a90e2;
        }

        /* PR√çNCIPE KAEL */
        .kael {
            width: 55px;
            height: 95px;
            bottom: 20%;
            right: 25%;
        }

        .kael-body {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #2a2a2a 0%, #1a1a1a 100%);
            border-radius: 10px;
            position: relative;
        }

        .kael-head {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 40px;
            background: #d4a574;
            border-radius: 50%;
        }

        .kael-hair {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 25px;
            background: #f0f0f0;
            border-radius: 50% 50% 0 0;
            clip-path: polygon(10% 100%, 0% 30%, 20% 0%, 40% 40%, 60% 0%, 80% 30%, 100% 100%);
        }

        .kael-scar {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 20px;
            background: #8b0000;
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            opacity: 0.8;
        }

        /* JOGADOR */
        .player {
            width: 50px;
            height: 80px;
            bottom: 20%;
            left: 20%;
            z-index: 100;
            transition: left 0.3s ease;
        }

        .player-body {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #4a5568 0%, #2d3748 100%);
            border-radius: 10px;
            position: relative;
            box-shadow: 0 0 20px rgba(0,191,255,0.5);
        }

        .player-head {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 35px;
            background: #d4a574;
            border-radius: 50%;
        }

        .player-hair {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 20px;
            background: #2d3748;
            border-radius: 50% 50% 0 0;
        }

        /* DI√ÅLOGO */
        #dialogue-box {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30%;
            background: linear-gradient(180deg, rgba(0,0,0,0.95) 0%, rgba(10,10,15,0.98) 100%);
            border-top: 3px solid var(--valthoria-silver);
            padding: 20px;
            display: none;
            z-index: 500;
        }

        #dialogue-box.active { 
            display: block !important;
        }

        .speaker-name {
            color: var(--eco-blue);
            font-size: 10px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .dialogue-text {
            color: #e0e0e0;
            font-size: 10px;
            line-height: 1.8;
            margin-bottom: 15px;
            min-height: 60px;
        }

        .dialogue-choices {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .choice-btn {
            background: rgba(0,0,0,0.5);
            border: 2px solid #444;
            color: #888;
            padding: 8px 15px;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .choice-btn:hover, .choice-btn.selected {
            border-color: var(--eco-blue);
            color: var(--eco-blue);
            text-shadow: 0 0 10px var(--eco-blue);
            transform: translateX(10px);
            background: rgba(0,191,255,0.1);
        }

        /* HUD */
        #hud {
            position: absolute;
            top: 10px;
            left: 10px;
            display: flex;
            gap: 15px;
            z-index: 200;
        }

        .hud-item {
            background: rgba(0,0,0,0.8);
            border: 2px solid var(--valthoria-silver);
            padding: 8px 12px;
            font-size: 9px;
            color: var(--eco-blue);
        }

        .hud-label {
            color: #666;
            font-size: 7px;
            display: block;
            margin-bottom: 4px;
        }

        /* BOT√ÉO REWIND */
        #time-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            border: 2px solid var(--eco-blue);
            color: var(--eco-blue);
            padding: 10px 15px;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            cursor: pointer;
            z-index: 200;
            transition: all 0.3s;
        }

        #time-btn:hover {
            background: var(--eco-blue);
            color: #000;
        }

        #time-btn:disabled { 
            opacity: 0.3; 
            cursor: not-allowed;
            background: rgba(0,0,0,0.5);
        }

        /* INDICADOR */
        .interaction-indicator {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--eco-blue);
            font-size: 20px;
            animation: bounce 1s infinite;
            display: none;
            text-shadow: 0 0 10px var(--eco-blue);
        }

        .character:hover .interaction-indicator { 
            display: block; 
        }

        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-8px); }
        }

        /* TRANSICAO */
        #transition-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--fissure-black);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 999;
            flex-direction: column;
        }

        #transition-screen.active { 
            display: flex !important;
        }

        .transition-text {
            color: var(--eco-blue);
            font-size: 16px;
            text-align: center;
            line-height: 2;
            text-shadow: 0 0 20px var(--eco-blue);
        }

        /* NOTIFICA√á√ÉO */
        #notification {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.95);
            border: 3px solid var(--eco-blue);
            padding: 25px;
            font-size: 10px;
            color: var(--eco-blue);
            text-align: center;
            display: none;
            z-index: 1001;
            max-width: 450px;
            box-shadow: 0 0 30px rgba(0,191,255,0.3);
        }

        #notification.active { 
            display: block !important;
            animation: popIn 0.3s ease-out;
        }

        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        /* MAPA */
        #quick-map {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.9);
            border: 2px solid var(--valthoria-silver);
            padding: 12px;
            font-size: 8px;
            z-index: 200;
        }

        .map-location {
            color: #666;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s;
            padding: 3px;
        }

        .map-location:hover, .map-location.active { 
            color: var(--eco-blue);
            text-shadow: 0 0 5px var(--eco-blue);
        }

        .typing::after {
            content: '‚ñã';
            animation: cursor 1s infinite;
        }

        @keyframes cursor {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
    </style>
<base target="_blank">
</head>
<body>
    <div id="game-container">
        <!-- NOTIFICA√á√ÉO -->
        <div id="notification"></div>

        <!-- TELA DE T√çTULO -->
        <div id="title-screen">
            <h1 class="game-title">CHRONOS ECHO</h1>
            <p class="subtitle">Parte 1: O Despertar</p>
            <button class="menu-option selected" onclick="startGame()">‚ñ∫ NOVO JOGO</button>
            <button class="menu-option" onclick="loadGame()">CARREGAR JOGO</button>
            <button class="menu-option" onclick="showTutorial()">TUTORIAL</button>
            <button class="menu-option" onclick="showCredits()">CR√âDITOS</button>
        </div>

        <!-- TELA DE TRANSICAO -->
        <div id="transition-screen">
            <p class="transition-text"></p>
        </div>

        <!-- √ÅREA DO JOGO -->
        <div id="game-area">
            <div id="hud">
                <div class="hud-item">
                    <span class="hud-label">LOCAL</span>
                    <span id="location-name">VALTHORIA</span>
                </div>
                <div class="hud-item">
                    <span class="hud-label">ECO-ZERO</span>
                    <span id="eco-status">DESCONHECIDO</span>
                </div>
                <div class="hud-item">
                    <span class="hud-label">KAEL</span>
                    <span id="kael-mood">NEUTRO</span>
                </div>
            </div>

            <button id="time-btn" onclick="rewindTime()">‚è™ REWIND (3)</button>

            <div id="quick-map">
                <div class="map-location active" onclick="travelTo('valthoria')">üè∞ VALTHORIA</div>
                <div class="map-location" onclick="travelTo('fissure')">üåå FISSURAS</div>
            </div>

            <div id="scene">
                <div class="background bg-valthoria" id="bg-valthoria">
                    <div class="throne"></div>

                    <div class="character player" id="player" onclick="movePlayer()">
                        <div class="player-body">
                            <div class="player-head"><div class="player-hair"></div></div>
                        </div>
                        <div class="interaction-indicator">‚ñº</div>
                    </div>

                    <div class="character aldrich" id="aldrich" onclick="interactWith('aldrich')">
                        <div class="aldrich-body">
                            <div class="aldrich-head">
                                <div class="aldrich-crown">üëë</div>
                                <div class="aldrich-eyes">
                                    <div class="aldrich-eye"></div>
                                    <div class="aldrich-eye"></div>
                                </div>
                            </div>
                        </div>
                        <div class="interaction-indicator">!</div>
                    </div>

                    <div class="character kael" id="kael" onclick="interactWith('kael')">
                        <div class="kael-body">
                            <div class="kael-scar"></div>
                            <div class="kael-head"><div class="kael-hair"></div></div>
                        </div>
                        <div class="interaction-indicator">!</div>
                    </div>
                </div>

                <div class="background bg-fissure" id="bg-fissure" style="display:none">
                    <div class="clock-pile"></div>

                    <div class="character eco-zero" id="eco-zero" onclick="interactWith('eco-zero')">
                        <div class="eco-zero-body">
                            <div class="eco-zero-head">
                                <div class="eco-zero-hair"></div>
                                <div class="eco-zero-eyes">
                                    <div class="eco-eye"></div>
                                    <div class="eco-eye"></div>
                                </div>
                                <div class="eco-tears">
                                    <div class="eco-tear"></div>
                                    <div class="eco-tear"></div>
                                </div>
                            </div>
                            <div class="eco-clock"></div>
                        </div>
                        <div class="interaction-indicator">!</div>
                    </div>
                </div>
            </div>

            <div id="dialogue-box">
                <div class="speaker-name" id="speaker">???</div>
                <div class="dialogue-text" id="dialogue-text"></div>
                <div class="dialogue-choices" id="choices"></div>
            </div>
        </div>
    </div>

    <script>
        // ESTADO DO JOGO
        const gameState = {
            location: 'valthoria',
            ecoZeroVisits: 0,
            ecoZeroPhase: 0,
            kaelMood: 50,
            aldrichState: 1,
            playerChoices: [],
            timeRewinds: 3,
            typingSpeed: 35,
            gameStarted: false
        };

        // DI√ÅLOGOS
        const dialogues = {
            aldrich: {
                name: 'REI ALDRIC III',
                text: 'Valthoria prospera. O Rei ama sua Rainha. O Rei ama seu povo... [a ilus√£o treme]',
                choices: [
                    { text: 'Vossa Majestade, posso falar?', next: 'aldrich_lucid' },
                    { text: '[Observar de perto]', next: 'aldrich_see' },
                    { text: '[Ir embora]', next: null }
                ]
            },
            aldrich_lucid: {
                name: 'REI ALDRIC III',
                text: '[Olhos focam em voc√™ por um segundo] Ajude-me. Por favor. Me mate. Eu n√£o deveria existir. Ela me mant√©m preso.',
                choices: [
                    { text: 'Quem?', next: 'aldrich_explain' },
                    { text: 'Como posso ajudar?', next: 'aldrich_help' }
                ]
            },
            aldrich_see: {
                name: 'NARRADOR',
                text: 'Voc√™ observa: o pesco√ßo do Rei √© transl√∫cido por instantes. Voc√™ v√™... ossos? Ilus√£o m√°gica falhando.',
                choices: [
                    { text: 'O que √© voc√™?', next: 'aldrich_lucid' },
                    { text: '[Recuar]', next: null }
                ]
            },
            aldrich_explain: {
                name: 'REI ALDRIC III',
                text: 'Seraphina. Minha esposa. Ela tem medo de ficar sozinha. Ent√£o me preserva. Com magia proibida. Com minha alma presa nesta podrid√£o.',
                choices: [
                    { text: 'Isso √© terr√≠vel...', next: 'aldrich_quest' }
                ]
            },
            aldrich_help: {
                name: 'REI ALDRIC III',
                text: 'Fale com Kael. Meu filho. Ele sabe a verdade h√° dez anos. Ou... destrua o anel em meu dedo. Mas isso me mataria de verdade.',
                choices: [
                    { text: 'Falarei com Kael', next: null, action: () => startQuest('kael') },
                    { text: 'Destruirei o anel', next: null, action: () => startQuest('kill') }
                ]
            },
            aldrich_quest: {
                name: 'REI ALDRIC III',
                text: '[Sorriso triste] Obrigado. Algu√©m que ouve. Algu√©m que v√™. V√°. Antes que a lucidez passe.',
                choices: [
                    { text: '[Sair]', next: null }
                ]
            },
            kael: {
                name: 'PR√çNCIPE KAEL',
                text: '[Sentado nos degraus, n√£o no trono. Espada cravada no ch√£o entre ele e o assento] Voc√™ √© o Eco. O profetizado. Ou a maldi√ß√£o. Ainda n√£o decidi.',
                choices: [
                    { text: 'Posso me sentar?', next: 'kael_sit' },
                    { text: 'Por que n√£o no trono?', next: 'kael_throne' },
                    { text: 'Seu pai pediu para falar contigo', next: 'kael_dad', condition: () => hasQuest('kael') }
                ]
            },
            kael_sit: {
                name: 'PR√çNCIPE KAEL',
                text: '[Risada seca] Sente. O ch√£o √© mais honesto que o trono. Mais frio tamb√©m. Mas honesto.',
                choices: [
                    { text: '[Sentar ao lado]', next: null, effect: () => changeKaelMood(10) },
                    { text: 'Prefiro ficar de p√©', next: null }
                ]
            },
            kael_throne: {
                name: 'PR√çNCIPE KAEL',
                text: '[Toca a queimadura em forma de cora√ß√£o no peito] Porque l√° em cima est√° meu pai. Ou o que resta. E eu... n√£o consigo olhar para ele sem querer quebrar tudo.',
                choices: [
                    { text: 'Voc√™ sabe a verdade?', next: 'kael_truth' },
                    { text: 'Conte-me sobre a queimadura', next: 'kael_scar' }
                ]
            },
            kael_truth: {
                name: 'PR√çNCIPE KAEL',
                text: 'Sei h√° dez anos. Aos quinze, entrei sem bater. Vi... o que ela fez. O que ele se tornou. E o pior? Entendo. Ela tem medo. Ele deixou. Eu faria o mesmo?',
                choices: [
                    { text: 'N√£o sei', next: null, effect: () => changeKaelMood(10) },
                    { text: 'N√£o. Morte √© parte da vida', next: null, effect: () => changeKaelMood(5) },
                    { text: 'Se amasse tanto... talvez', next: null, effect: () => changeKaelMood(15) }
                ]
            },
            kael_scar: {
                name: 'PR√çNCIPE KAEL',
                text: 'Fiz aos quinze. Quando descobri. Quis me punir por n√£o ter percebido antes. Por n√£o ter salvado ele. Agora √©... lembran√ßa. De quem eu era. Do que perdi.',
                choices: [
                    { text: 'Voc√™ n√£o podia saber', next: null, effect: () => changeKaelMood(10) },
                    { text: 'A dor molda', next: null, effect: () => changeKaelMood(5) }
                ]
            },
            kael_dad: {
                name: 'PR√çNCIPE KAEL',
                text: '[Espada treme na m√£o] Ele... ele falou? Depois de dez anos de sil√™ncio? O que disse?',
                choices: [
                    { text: 'Pediu para ser libertado', next: 'kael_free' }
                ]
            },
            kael_free: {
                name: 'PR√çNCIPE KAEL',
                text: 'Libertado. Morte. Ele quer morte. E eu... eu quero negar. Quero mant√™-lo. Como ela. Sou igual a ela. [voz quebra] Ou sou pior? Porque eu sei. E ainda assim...',
                choices: [
                    { text: 'Voc√™ n√£o √© sua m√£e', next: null, effect: () => changeKaelMood(20) },
                    { text: 'Mas entende o sofrimento dele', next: null, effect: () => changeKaelMood(10) }
                ]
            }
        };

        const ecoZeroDialogues = {
            0: {
                name: 'ECO-ZERO',
                text: '[N√£o olha para voc√™. Costas curvadas, sentado em pilha de rel√≥gios quebrados] Voc√™ demorou. Eu te esperei em oitocentas e quarenta e sete linhas temporais.',
                choices: [
                    { text: 'Como sabe quem sou?', next: 'eco_know' },
                    { text: 'Por que me esperava?', next: 'eco_why' },
                    { text: '[Sair em sil√™ncio]', next: null, effect: () => { gameState.ecoZeroPhase = -1; } }
                ]
            },
            1: {
                name: 'ECO-ZERO',
                text: '[Sorriso torto, olhos brancos vazios] Olha s√≥. O her√≥i. O escolhido. Quer saber o que acontece com especiais? EU SEI. EU SEI PORQUE EU FUI VOC√ä.',
                choices: [
                    { text: 'Voc√™ foi eu?', next: 'eco_was' },
                    { text: 'N√£o me chame de especial', next: 'eco_special' }
                ]
            },
            5: {
                name: 'ECO-ZERO',
                text: '[Sorriso genu√≠no, quase humano] Voc√™ voltou. De novo. Mesmo sabendo o que eu sou. O que eu fiz. [estende m√£o] Obrigado. Por n√£o me deixar esquecer de mim.',
                choices: [
                    { text: 'Vamos juntos da pr√≥xima vez', next: null, action: () => alert('ECO-ZERO agora √© seu companheiro!') },
                    { text: 'Sempre volto', next: null }
                ]
            }
        };

        // FUN√á√ïES CORRIGIDAS
        function startGame() {
            console.log('Iniciando jogo...');

            // Esconder tela de t√≠tulo
            const titleScreen = document.getElementById('title-screen');
            titleScreen.classList.add('hidden');

            // Mostrar √°rea do jogo
            const gameArea = document.getElementById('game-area');
            gameArea.style.display = 'block';

            // For√ßar reflow
            void gameArea.offsetWidth;

            gameArea.classList.add('active');
            gameState.gameStarted = true;

            console.log('Game area ativa:', gameArea.classList.contains('active'));

            // Mostrar transi√ß√£o
            showTransition('Valthoria
Reino do Crep√∫sculo Eterno

Ano 847 da Era do Rel√≥gio', () => {
                updateHUD();
                showNotification('Bem-vindo a CHRONOS ECHO!

üéÆ CLIQUE nos personagens para falar
üó∫Ô∏è Use o MAPA (canto inferior direito) para viajar
‚è™ REWIND reverte escolhas (3 usos)

DICA: Visite Eco-Zero 10 vezes nas Fissuras!');
            });
        }

        function showTransition(text, callback) {
            const screen = document.getElementById('transition-screen');
            const textEl = screen.querySelector('.transition-text');

            textEl.innerHTML = text.replace(/\n/g, '<br>');
            screen.style.display = 'flex';
            screen.classList.add('active');

            console.log('Transi√ß√£o ativa');

            setTimeout(() => {
                screen.classList.remove('active');
                screen.style.display = 'none';
                console.log('Transi√ß√£o terminada');
                if (callback) callback();
            }, 3000);
        }

        function showNotification(text) {
            const notif = document.getElementById('notification');
            notif.innerHTML = text.replace(/\n/g, '<br>');
            notif.style.display = 'block';
            notif.classList.add('active');

            setTimeout(() => {
                notif.classList.remove('active');
                notif.style.display = 'none';
            }, 6000);
        }

        function updateHUD() {
            document.getElementById('location-name').textContent = gameState.location === 'valthoria' ? 'VALTHORIA' : 'FISSURAS';

            const ecoStatuses = ['DESCONHECIDO', 'HOSTIL', 'IRA', 'VAZIO', 'ANSIOSO', 'COMPANHEIRO', 'PERDIDO'];
            document.getElementById('eco-status').textContent = ecoStatuses[gameState.ecoZeroPhase] || '???';

            const kaelStatus = gameState.kaelMood < 30 ? 'HOSTIL' : 
                              gameState.kaelMood < 50 ? 'C√âTICO' :
                              gameState.kaelMood < 70 ? 'NEUTRO' :
                              gameState.kaelMood < 90 ? 'AMIGO' : 'LEAL';
            document.getElementById('kael-mood').textContent = kaelStatus;

            const btn = document.getElementById('time-btn');
            btn.textContent = '‚è™ REWIND (' + gameState.timeRewinds + ')';
            btn.disabled = gameState.timeRewinds <= 0;
        }

        function travelTo(location) {
            if (location === gameState.location) return;

            gameState.location = location;

            document.getElementById('bg-valthoria').style.display = location === 'valthoria' ? 'block' : 'none';
            document.getElementById('bg-fissure').style.display = location === 'fissure' ? 'block' : 'none';

            document.querySelectorAll('.map-location').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');

            const locName = location === 'valthoria' ? 'Valthoria' : 'As Fissuras';
            showTransition(locName, () => {
                updateHUD();
                if (location === 'fissure' && gameState.ecoZeroVisits === 0) {
                    gameState.ecoZeroVisits++;
                    setTimeout(() => startDialogue('eco-zero'), 800);
                }
            });
        }

        function startDialogue(character) {
            console.log('Iniciando di√°logo:', character);

            const box = document.getElementById('dialogue-box');
            const speaker = document.getElementById('speaker');
            const text = document.getElementById('dialogue-text');
            const choices = document.getElementById('choices');

            box.style.display = 'block';
            box.classList.add('active');

            let data;
            if (character === 'eco-zero') {
                data = ecoZeroDialogues[gameState.ecoZeroPhase] || ecoZeroDialogues[0];
            } else {
                data = dialogues[character];
            }

            if (!data) {
                closeDialogue();
                return;
            }

            speaker.textContent = data.name;
            text.textContent = '';
            text.classList.add('typing');

            let i = 0;
            const interval = setInterval(() => {
                text.textContent += data.text[i];
                i++;
                if (i >= data.text.length) {
                    clearInterval(interval);
                    text.classList.remove('typing');
                    showChoices(data.choices);
                }
            }, gameState.typingSpeed);
        }

        function showChoices(choices) {
            const container = document.getElementById('choices');
            container.innerHTML = '';

            choices.forEach((choice, idx) => {
                if (choice.condition && !choice.condition()) return;

                const btn = document.createElement('button');
                btn.className = 'choice-btn' + (idx === 0 ? ' selected' : '');
                btn.textContent = '> ' + choice.text;
                btn.onclick = () => selectChoice(choice);
                container.appendChild(btn);
            });
        }

        function selectChoice(choice) {
            if (choice.effect) choice.effect();
            if (choice.action) choice.action();

            if (choice.next && dialogues[choice.next]) {
                // Continuar di√°logo
                const data = dialogues[choice.next];
                document.getElementById('speaker').textContent = data.name;
                const text = document.getElementById('dialogue-text');
                text.textContent = '';
                text.classList.add('typing');

                let i = 0;
                const interval = setInterval(() => {
                    text.textContent += data.text[i];
                    i++;
                    if (i >= data.text.length) {
                        clearInterval(interval);
                        text.classList.remove('typing');
                        showChoices(data.choices);
                    }
                }, gameState.typingSpeed);
            } else {
                closeDialogue();
            }

            updateHUD();
            saveGame();
        }

        function closeDialogue() {
            const box = document.getElementById('dialogue-box');
            box.classList.remove('active');
            box.style.display = 'none';
        }

        function interactWith(char) {
            console.log('Interagindo com:', char);
            if (char === 'eco-zero') {
                gameState.ecoZeroVisits++;
                if (gameState.ecoZeroVisits === 2) gameState.ecoZeroPhase = 1;
                if (gameState.ecoZeroVisits >= 10) gameState.ecoZeroPhase = 5;
            }
            startDialogue(char);
        }

        function rewindTime() {
            if (gameState.timeRewinds <= 0) return;
            gameState.timeRewinds--;
            showNotification('‚è™ TEMPO REVERTIDO!\n\nRewinds restantes: ' + gameState.timeRewinds);
            updateHUD();
        }

        function movePlayer() {
            const player = document.getElementById('player');
            const current = player.style.left || '20%';
            player.style.left = current === '50%' ? '20%' : '50%';
        }

        function changeKaelMood(amount) {
            gameState.kaelMood = Math.max(0, Math.min(100, gameState.kaelMood + amount));
            showNotification('Kael: ' + (amount > 0 ? '+' : '') + amount + ' de afinidade');
        }

        function startQuest(id) {
            gameState.playerChoices.push(id);
            showNotification('QUEST INICIADA!\nVerifique seu progresso no HUD.');
        }

        function hasQuest(id) {
            return gameState.playerChoices.includes(id);
        }

        function saveGame() {
            localStorage.setItem('chronos_echo_save', JSON.stringify(gameState));
        }

        function loadGame() {
            const save = localStorage.getItem('chronos_echo_save');
            if (save) {
                Object.assign(gameState, JSON.parse(save));
                document.getElementById('title-screen').classList.add('hidden');
                document.getElementById('game-area').style.display = 'block';
                document.getElementById('game-area').classList.add('active');
                updateHUD();
                showNotification('Jogo carregado!');
            } else {
                alert('Nenhum save encontrado');
            }
        }

        function showTutorial() {
            showNotification('TUTORIAL:\n\nüéÆ CLIQUE nos personagens para falar\nüó∫Ô∏è MAPA (canto inferior direito) para viajar\n‚è™ REWIND reverte escolhas (3x)\nüíæ F5 = Salvar | F9 = Carregar\n\nDICA: Visite Eco-Zero 10x nas Fissuras para companheiro!');
        }

        function showCredits() {
            showNotification('CHRONOS ECHO - Parte 1\n\nüé® Conceito: Usu√°rio + IA\nüíª C√≥digo: HTML5/CSS/JS\n\nPersonagens:\n‚Ä¢ Eco-Zero: O Eco Quebrado\n‚Ä¢ Aldric III: O Morto-Vivo\n‚Ä¢ Kael: O Herdeiro de Cinzas\n‚Ä¢ Seraphina: A Vi√∫va de Gelo');
        }

        // Auto-save
        setInterval(saveGame, 30000);

        // Teclas
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeDialogue();
            if (e.key === 'F5') { e.preventDefault(); saveGame(); showNotification('Jogo salvo!'); }
            if (e.key === 'F9') { e.preventDefault(); loadGame(); }
        });

        console.log('CHRONOS ECHO carregado. Pronto para jogar!');
    </script>
</body>
</html>
