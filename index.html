<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHRONOS ECHO - Parte 1: O Despertar</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        :root {
            --valthoria-blue: #1a237e;
            --valthoria-silver: #c0c0c0;
            --eco-blue: #00bfff;
            --eco-gray: #a0a0a0;
            --fissure-black: #0a0a0f;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; image-rendering: pixelated; }

        body {
            background: #000;
            color: #e0e0e0;
            font-family: 'Press Start 2P', cursive;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-container {
            width: 1024px;
            height: 576px;
            background: #000;
            position: relative;
            box-shadow: 0 0 50px rgba(0, 191, 255, 0.3);
            border: 4px solid var(--valthoria-silver);
        }

        /* TELA DE T√çTULO */
        #title-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, var(--fissure-black) 0%, #1a1a2e 50%, var(--valthoria-blue) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s;
        }

        #title-screen.hidden { opacity: 0; pointer-events: none; }

        .game-title {
            font-size: 48px;
            color: var(--eco-blue);
            text-shadow: 0 0 20px var(--eco-blue);
            margin-bottom: 20px;
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .subtitle { font-size: 14px; color: var(--valthoria-silver); margin-bottom: 40px; }

        .menu-option {
            font-size: 12px;
            color: #888;
            margin: 12px 0;
            cursor: pointer;
            transition: all 0.3s;
            padding: 10px 20px;
            border: 2px solid transparent;
        }

        .menu-option:hover, .menu-option.selected {
            color: var(--eco-blue);
            border-color: var(--eco-blue);
            text-shadow: 0 0 10px var(--eco-blue);
            transform: translateX(10px);
        }

        /* √ÅREA DO JOGO */
        #game-area {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
        }

        #game-area.active { display: block; }

        /* CEN√ÅRIOS */
        #scene {
            width: 100%;
            height: 70%;
            position: relative;
            overflow: hidden;
        }

        .background {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: opacity 0.5s;
        }

        .bg-valthoria {
            background: linear-gradient(180deg, #2a2a4a 0%, #1a1a3e 50%, #0f0f1f 100%);
        }

        .bg-valthoria::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent 0px, transparent 80px, rgba(192,192,192,0.1) 80px, rgba(192,192,192,0.1) 100px);
        }

        .throne {
            position: absolute;
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 160px;
            background: radial-gradient(circle at 20% 20%, #4a4a4a 0%, #2a2a2a 30%, transparent 31%),
                        radial-gradient(circle at 80% 20%, #4a4a4a 0%, #2a2a2a 30%, transparent 31%),
                        radial-gradient(circle at 50% 80%, #3a3a3a 0%, #1a1a1a 40%, transparent 41%);
            border: 3px solid #5a5a5a;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
        }

        .throne::after {
            content: 'üëë';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 30px;
            filter: grayscale(100%) brightness(0.7);
        }

        .bg-fissure {
            background: var(--fissure-black);
            position: relative;
        }

        .bg-fissure::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3, #ff0000);
            opacity: 0.1;
            animation: rotate 15s linear infinite;
        }

        @keyframes rotate {
            0% { transform: translate(-25%, -25%) rotate(0deg); }
            100% { transform: translate(-25%, -25%) rotate(360deg); }
        }

        .clock-pile {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40%;
            background: repeating-radial-gradient(circle at 30% 80%, #4a3a2a 0px, #2a1a0a 15px, transparent 16px);
            opacity: 0.6;
        }

        /* PERSONAGENS */
        .character {
            position: absolute;
            transition: all 0.3s;
            cursor: pointer;
        }

        .character:hover { filter: brightness(1.2); }

        /* ECO-ZERO */
        .eco-zero {
            width: 60px;
            height: 100px;
            bottom: 25%;
            left: 50%;
            transform: translateX(-50%);
        }

        .eco-zero-body {
            width: 100%;
            height: 100%;
            background: var(--eco-gray);
            border-radius: 10px 10px 20px 20px;
            position: relative;
            box-shadow: inset -10px 0 20px rgba(0,0,0,0.5), 0 0 20px rgba(0,191,255,0.3);
            animation: glitch 4s infinite;
        }

        @keyframes glitch {
            0%, 90%, 100% { transform: translate(0); }
            91% { transform: translate(-2px, 1px); }
            92% { transform: translate(2px, -1px); }
            93% { transform: translate(0); }
        }

        .eco-zero-head {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: var(--eco-gray);
            border-radius: 50%;
        }

        .eco-zero-eyes {
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 0 5px;
        }

        .eco-eye {
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 10px #fff;
            animation: blink 5s infinite;
        }

        @keyframes blink {
            0%, 48%, 52%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.1); }
        }

        .eco-zero-hair {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 30px;
            background: #f0f0f0;
            border-radius: 50% 50% 0 0;
            clip-path: polygon(20% 100%, 0% 50%, 10% 0%, 30% 30%, 50% 0%, 70% 30%, 90% 0%, 100% 50%, 80% 100%);
        }

        .eco-tears {
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 0 8px;
        }

        .eco-tear {
            width: 3px;
            height: 8px;
            background: #1a1a1a;
            border-radius: 0 0 50% 50%;
            animation: drop 3s infinite;
        }

        @keyframes drop {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(5px); }
        }

        .eco-clock {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: #4a3a2a;
            border: 2px solid #ffd700;
            border-radius: 50%;
        }

        /* REI ALDRIC */
        .aldrich {
            width: 70px;
            height: 110px;
            bottom: 25%;
            left: 50%;
            transform: translateX(-50%);
        }

        .aldrich-body {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #1a237e 0%, #0f0f3e 100%);
            border-radius: 15px;
            position: relative;
            box-shadow: 0 0 30px rgba(26,35,126,0.5);
        }

        .aldrich-head {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 45px;
            height: 50px;
            background: linear-gradient(180deg, #d4a574 0%, #c49464 50%, #8b7355 100%);
            border-radius: 50%;
            overflow: hidden;
        }

        .aldrich-crown {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 25px;
            filter: brightness(1.5);
        }

        .aldrich-eyes {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 0 8px;
        }

        .aldrich-eye {
            width: 8px;
            height: 8px;
            background: #4a90e2;
            border-radius: 50%;
            box-shadow: 0 0 5px #4a90e2;
        }

        /* PR√çNCIPE KAEL */
        .kael {
            width: 55px;
            height: 95px;
            bottom: 20%;
            right: 25%;
        }

        .kael-body {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #2a2a2a 0%, #1a1a1a 100%);
            border-radius: 10px;
            position: relative;
        }

        .kael-head {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 40px;
            background: #d4a574;
            border-radius: 50%;
        }

        .kael-hair {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 25px;
            background: #f0f0f0;
            border-radius: 50% 50% 0 0;
            clip-path: polygon(10% 100%, 0% 30%, 20% 0%, 40% 40%, 60% 0%, 80% 30%, 100% 100%);
        }

        .kael-scar {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 20px;
            background: #8b0000;
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            opacity: 0.8;
        }

        /* JOGADOR */
        .player {
            width: 50px;
            height: 80px;
            bottom: 20%;
            left: 20%;
            z-index: 100;
        }

        .player-body {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #4a5568 0%, #2d3748 100%);
            border-radius: 10px;
            position: relative;
            box-shadow: 0 0 20px rgba(0,191,255,0.5);
        }

        .player-head {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 35px;
            background: #d4a574;
            border-radius: 50%;
        }

        .player-hair {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 20px;
            background: #2d3748;
            border-radius: 50% 50% 0 0;
        }

        /* DI√ÅLOGO */
        #dialogue-box {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 30%;
            background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, rgba(10,10,15,0.95) 100%);
            border-top: 3px solid var(--valthoria-silver);
            padding: 15px;
            display: none;
            z-index: 500;
        }

        #dialogue-box.active { display: block; }

        .speaker-name {
            color: var(--eco-blue);
            font-size: 10px;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .dialogue-text {
            color: #e0e0e0;
            font-size: 10px;
            line-height: 1.6;
            margin-bottom: 12px;
            min-height: 50px;
        }

        .dialogue-choices {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .choice-btn {
            background: transparent;
            border: 2px solid #444;
            color: #888;
            padding: 6px 12px;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .choice-btn:hover, .choice-btn.selected {
            border-color: var(--eco-blue);
            color: var(--eco-blue);
            text-shadow: 0 0 10px var(--eco-blue);
            transform: translateX(10px);
        }

        /* HUD */
        #hud {
            position: absolute;
            top: 10px;
            left: 10px;
            display: flex;
            gap: 15px;
            z-index: 200;
        }

        .hud-item {
            background: rgba(0,0,0,0.7);
            border: 2px solid var(--valthoria-silver);
            padding: 6px 10px;
            font-size: 9px;
            color: var(--eco-blue);
        }

        .hud-label {
            color: #666;
            font-size: 7px;
            display: block;
            margin-bottom: 3px;
        }

        /* BOT√ÉO REWIND */
        #time-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            border: 2px solid var(--eco-blue);
            color: var(--eco-blue);
            padding: 8px 12px;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            cursor: pointer;
            z-index: 200;
        }

        #time-btn:hover {
            background: var(--eco-blue);
            color: #000;
        }

        #time-btn:disabled { opacity: 0.3; cursor: not-allowed; }

        /* INDICADOR */
        .interaction-indicator {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--eco-blue);
            font-size: 16px;
            animation: bounce 1s infinite;
            display: none;
        }

        .character:hover .interaction-indicator { display: block; }

        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }

        /* TRANSICAO */
        #transition-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--fissure-black);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 999;
            flex-direction: column;
        }

        #transition-screen.active { display: flex; }

        .transition-text {
            color: var(--eco-blue);
            font-size: 14px;
            text-align: center;
            line-height: 2;
        }

        /* NOTIFICA√á√ÉO */
        #notification {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            border: 2px solid var(--eco-blue);
            padding: 20px;
            font-size: 10px;
            color: var(--eco-blue);
            text-align: center;
            display: none;
            z-index: 1000;
            max-width: 400px;
        }

        #notification.active { display: block; }

        /* MAPA */
        #quick-map {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            border: 2px solid var(--valthoria-silver);
            padding: 10px;
            font-size: 8px;
            z-index: 200;
        }

        .map-location {
            color: #666;
            margin: 3px 0;
            cursor: pointer;
        }

        .map-location:hover, .map-location.active { color: var(--eco-blue); }

        .typing::after {
            content: '‚ñã';
            animation: cursor 1s infinite;
        }

        @keyframes cursor {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
    </style>
<base target="_blank">
</head>
<body>
    <div id="game-container">
        <div id="notification"></div>

        <div id="title-screen">
            <h1 class="game-title">CHRONOS ECHO</h1>
            <p class="subtitle">Parte 1: O Despertar</p>
            <div class="menu-option selected" onclick="startGame()">‚ñ∫ NOVO JOGO</div>
            <div class="menu-option" onclick="loadGame()">CARREGAR</div>
            <div class="menu-option" onclick="showTutorial()">TUTORIAL</div>
            <div class="menu-option" onclick="showCredits()">CR√âDITOS</div>
        </div>

        <div id="transition-screen">
            <p class="transition-text"></p>
        </div>

        <div id="game-area">
            <div id="hud">
                <div class="hud-item">
                    <span class="hud-label">LOCAL</span>
                    <span id="location-name">???</span>
                </div>
                <div class="hud-item">
                    <span class="hud-label">ECO-ZERO</span>
                    <span id="eco-status">DESCONHECIDO</span>
                </div>
                <div class="hud-item">
                    <span class="hud-label">KAEL</span>
                    <span id="kael-mood">NEUTRO</span>
                </div>
            </div>

            <button id="time-btn" onclick="rewindTime()">‚è™ REWIND (3)</button>

            <div id="quick-map">
                <div class="map-location active" onclick="travelTo('valthoria')">üè∞ VALTHORIA</div>
                <div class="map-location" onclick="travelTo('fissure')">üåå FISSURAS</div>
            </div>

            <div id="scene">
                <div class="background bg-valthoria" id="bg-valthoria">
                    <div class="throne"></div>

                    <div class="character player" id="player" onclick="movePlayer()">
                        <div class="player-body">
                            <div class="player-head"><div class="player-hair"></div></div>
                        </div>
                        <div class="interaction-indicator">‚åÑ</div>
                    </div>

                    <div class="character aldrich" id="aldrich" onclick="interactWith('aldrich')">
                        <div class="aldrich-body">
                            <div class="aldrich-head">
                                <div class="aldrich-crown">üëë</div>
                                <div class="aldrich-eyes">
                                    <div class="aldrich-eye"></div>
                                    <div class="aldrich-eye"></div>
                                </div>
                            </div>
                        </div>
                        <div class="interaction-indicator">!</div>
                    </div>

                    <div class="character kael" id="kael" onclick="interactWith('kael')">
                        <div class="kael-body">
                            <div class="kael-scar"></div>
                            <div class="kael-head"><div class="kael-hair"></div></div>
                        </div>
                        <div class="interaction-indicator">!</div>
                    </div>
                </div>

                <div class="background bg-fissure" id="bg-fissure" style="display:none">
                    <div class="clock-pile"></div>

                    <div class="character player" id="player-fissure">
                        <div class="player-body">
                            <div class="player-head"><div class="player-hair"></div></div>
                        </div>
                        <div class="interaction-indicator">‚åÑ</div>
                    </div>

                    <div class="character eco-zero" id="eco-zero" onclick="interactWith('eco-zero')">
                        <div class="eco-zero-body">
                            <div class="eco-zero-head">
                                <div class="eco-zero-hair"></div>
                                <div class="eco-zero-eyes">
                                    <div class="eco-eye"></div>
                                    <div class="eco-eye"></div>
                                </div>
                                <div class="eco-tears">
                                    <div class="eco-tear"></div>
                                    <div class="eco-tear"></div>
                                </div>
                            </div>
                            <div class="eco-clock"></div>
                        </div>
                        <div class="interaction-indicator">!</div>
                    </div>
                </div>
            </div>

            <div id="dialogue-box">
                <div class="speaker-name" id="speaker">???</div>
                <div class="dialogue-text typing" id="dialogue-text"></div>
                <div class="dialogue-choices" id="choices"></div>
            </div>
        </div>
    </div>

    <script>
        const gameState = {
            location: 'valthoria',
            ecoZeroVisits: 0,
            ecoZeroPhase: 0,
            kaelMood: 50,
            aldrichState: 1,
            playerChoices: [],
            timeRewinds: 3,
            typingSpeed: 30
        };

        const dialogues = {
            aldrich: {
                name: 'REI ALDRIC III',
                text: 'Valthoria prospera. O Rei ama sua Rainha... [ilu√ß√£o treme]',
                choices: [
                    { text: 'Vossa Majestade?', next: 'aldrich_lucid' },
                    { text: '[Observar de perto]', next: 'aldrich_see' },
                    { text: '[Ir embora]', next: null }
                ]
            },
            aldrich_lucid: {
                name: 'REI ALDRIC III',
                text: '[Olhos focam] Ajude-me. Por favor. Me mate. Eu n√£o deveria existir. Ela me mant√©m preso.',
                choices: [
                    { text: 'Quem?', next: 'aldrich_explain' },
                    { text: 'Como posso ajudar?', next: 'aldrich_help' }
                ]
            },
            aldrich_see: {
                name: 'NARRADOR',
                text: 'Voc√™ v√™: o pesco√ßo do Rei √© transl√∫cido. Osso brilha por baixo da pele. Ilus√£o m√°gica.',
                choices: [
                    { text: 'O que √© voc√™?', next: 'aldrich_lucid' },
                    { text: '[Recuar]', next: null }
                ]
            },
            aldrich_explain: {
                name: 'REI ALDRIC III',
                text: 'Seraphina. Minha esposa. Ela tem medo de ficar sozinha. Ent√£o me preserva. Com magia. Com minha alma presa nesta podrid√£o.',
                choices: [
                    { text: 'Terr√≠vel...', next: 'aldrich_quest' }
                ]
            },
            aldrich_help: {
                name: 'REI ALDRIC III',
                text: 'Fale com Kael. Meu filho. Ele sabe a verdade. Ou destrua o anel em meu dedo. Mas isso... isso me mataria de verdade.',
                choices: [
                    { text: 'Falarei com Kael', next: null, action: () => startQuest('kael') },
                    { text: 'Destruirei o anel', next: null, action: () => startQuest('kill') }
                ]
            },
            kael: {
                name: 'PR√çNCIPE KAEL',
                text: '[Sentado nos degraus, n√£o no trono] Voc√™ √© o Eco. O profetizado. Ou a maldi√ß√£o. Ainda n√£o decidi.',
                choices: [
                    { text: 'Posso me sentar?', next: 'kael_sit' },
                    { text: 'Seu pai pediu para falar contigo', next: 'kael_dad', condition: () => hasQuest('kael') }
                ]
            },
            kael_sit: {
                name: 'PR√çNCIPE KAEL',
                text: 'Sente. O ch√£o √© mais honesto que o trono. Mais frio tamb√©m. Mas honesto.',
                choices: [
                    { text: '[Sentar]', next: null, effect: () => changeKaelMood(10) },
                    { text: 'Prefiro ficar de p√©', next: null }
                ]
            },
            kael_dad: {
                name: 'PR√çNCIPE KAEL',
                text: '[Espada treme] Ele falou? Depois de dez anos? O que disse?',
                choices: [
                    { text: 'Pediu para ser libertado', next: 'kael_free' }
                ]
            },
            kael_free: {
                name: 'PR√çNCIPE KAEL',
                text: 'Libertado. Morte. Ele quer morte. E eu... eu quero negar. Quero mant√™-lo. Como ela. Sou igual a ela.',
                choices: [
                    { text: 'Voc√™ n√£o √© sua m√£e', next: null, effect: () => changeKaelMood(20) }
                ]
            }
        };

        const ecoZeroDialogues = {
            0: {
                name: 'ECO-ZERO',
                text: '[N√£o olha] Voc√™ demorou. Eu te esperei em 847 linhas temporais.',
                choices: [
                    { text: 'Como sabe quem sou?', next: 'eco_know' },
                    { text: 'Por que esperava?', next: 'eco_why' },
                    { text: '[Sair]', next: null }
                ]
            },
            1: {
                name: 'ECO-ZERO',
                text: '[Sorriso torto] Olha s√≥. O her√≥i. O escolhido. Quer saber o que acontece com especiais? EU SEI PORQUE EU FUI VOC√ä.',
                choices: [
                    { text: 'Voc√™ foi eu?', next: 'eco_was' },
                    { text: 'N√£o sou especial', next: 'eco_special' }
                ]
            },
            5: {
                name: 'ECO-ZERO',
                text: '[Sorriso genu√≠no] Voc√™ voltou. De novo. Obrigado. Por n√£o me deixar esquecer de mim.',
                choices: [
                    { text: 'Vamos juntos', next: null, action: () => alert('ECO-ZERO agora √© seu companheiro!') },
                    { text: 'Sempre volto', next: null }
                ]
            }
        };

        function startGame() {
            document.getElementById('title-screen').classList.add('hidden');
            showTransition('Valthoria
Reino do Crep√∫sculo Eterno', () => {
                document.getElementById('game-area').classList.add('active');
                updateHUD();
                showNotification('Bem-vindo!\nClique nos personagens para interagir.\nUse o mapa para viajar.');
            });
        }

        function showTransition(text, callback) {
            const screen = document.getElementById('transition-screen');
            screen.querySelector('.transition-text').innerHTML = text.replace(/\n/g, '<br>');
            screen.classList.add('active');
            setTimeout(() => {
                screen.classList.remove('active');
                if (callback) callback();
            }, 2500);
        }

        function showNotification(text) {
            const notif = document.getElementById('notification');
            notif.innerHTML = text.replace(/\n/g, '<br>');
            notif.classList.add('active');
            setTimeout(() => notif.classList.remove('active'), 4000);
        }

        function updateHUD() {
            document.getElementById('location-name').textContent = gameState.location === 'valthoria' ? 'VALTHORIA' : 'FISSURAS';

            const ecoStatuses = ['DESCONHECIDO', 'HOSTIL', 'IRA', 'VAZIO', 'ANSIOSO', 'COMPANHEIRO'];
            document.getElementById('eco-status').textContent = ecoStatuses[gameState.ecoZeroPhase] || '???';

            const kaelStatus = gameState.kaelMood < 30 ? 'HOSTIL' : gameState.kaelMood < 50 ? 'C√âTICO' : gameState.kaelMood < 70 ? 'NEUTRO' : gameState.kaelMood < 90 ? 'AMIGO' : 'LEAL';
            document.getElementById('kael-mood').textContent = kaelStatus;

            document.getElementById('time-btn').textContent = '‚è™ REWIND (' + gameState.timeRewinds + ')';
            if (gameState.timeRewinds <= 0) document.getElementById('time-btn').disabled = true;
        }

        function travelTo(location) {
            gameState.location = location;
            document.getElementById('bg-valthoria').style.display = location === 'valthoria' ? 'block' : 'none';
            document.getElementById('bg-fissure').style.display = location === 'fissure' ? 'block' : 'none';

            document.querySelectorAll('.map-location').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');

            showTransition(location === 'valthoria' ? 'Valthoria' : 'As Fissuras', () => {
                updateHUD();
                if (location === 'fissure' && gameState.ecoZeroVisits === 0) {
                    gameState.ecoZeroVisits++;
                    setTimeout(() => startDialogue('eco-zero'), 500);
                }
            });
        }

        function startDialogue(character) {
            const box = document.getElementById('dialogue-box');
            const speaker = document.getElementById('speaker');
            const text = document.getElementById('dialogue-text');
            const choices = document.getElementById('choices');

            box.classList.add('active');

            let data;
            if (character === 'eco-zero') {
                data = ecoZeroDialogues[gameState.ecoZeroPhase] || ecoZeroDialogues[0];
            } else {
                data = dialogues[character];
            }

            if (!data) { closeDialogue(); return; }

            speaker.textContent = data.name;
            text.textContent = '';
            text.classList.add('typing');

            let i = 0;
            const interval = setInterval(() => {
                text.textContent += data.text[i];
                i++;
                if (i >= data.text.length) {
                    clearInterval(interval);
                    text.classList.remove('typing');
                    showChoices(data.choices);
                }
            }, gameState.typingSpeed);
        }

        function showChoices(choices) {
            const container = document.getElementById('choices');
            container.innerHTML = '';

            choices.forEach((choice, idx) => {
                if (choice.condition && !choice.condition()) return;

                const btn = document.createElement('button');
                btn.className = 'choice-btn' + (idx === 0 ? ' selected' : '');
                btn.textContent = choice.text;
                btn.onclick = () => selectChoice(choice);
                container.appendChild(btn);
            });
        }

        function selectChoice(choice) {
            if (choice.effect) choice.effect();
            if (choice.action) choice.action();

            if (choice.next && dialogues[choice.next]) {
                startDialogue(choice.next);
            } else {
                closeDialogue();
            }

            updateHUD();
            saveGame();
        }

        function closeDialogue() {
            document.getElementById('dialogue-box').classList.remove('active');
        }

        function interactWith(char) {
            if (char === 'eco-zero') {
                gameState.ecoZeroVisits++;
                if (gameState.ecoZeroVisits === 2) gameState.ecoZeroPhase = 1;
                if (gameState.ecoZeroVisits >= 10) gameState.ecoZeroPhase = 5;
            }
            startDialogue(char);
        }

        function rewindTime() {
            if (gameState.timeRewinds <= 0) return;
            gameState.timeRewinds--;
            showNotification('‚è™ TEMPO REVERTIDO!\nRewinds restantes: ' + gameState.timeRewinds);
            updateHUD();
        }

        function movePlayer() {
            const player = document.getElementById('player');
            player.style.left = player.style.left === '50%' ? '20%' : '50%';
        }

        function changeKaelMood(amount) {
            gameState.kaelMood = Math.max(0, Math.min(100, gameState.kaelMood + amount));
            showNotification('Kael: +' + amount + ' de afinidade');
        }

        function startQuest(id) {
            gameState.playerChoices.push(id);
            showNotification('QUEST INICIADA!');
        }

        function hasQuest(id) {
            return gameState.playerChoices.includes(id);
        }

        function saveGame() {
            localStorage.setItem('chronos_echo_save', JSON.stringify(gameState));
        }

        function loadGame() {
            const save = localStorage.getItem('chronos_echo_save');
            if (save) {
                Object.assign(gameState, JSON.parse(save));
                document.getElementById('title-screen').classList.add('hidden');
                document.getElementById('game-area').classList.add('active');
                updateHUD();
                showNotification('Jogo carregado!');
            } else {
                alert('Nenhum save encontrado');
            }
        }

        function showTutorial() {
            showNotification('TUTORIAL:\n- CLICK: Interagir\n- MAPA: Viajar entre locais\n- REWIND: Reverter escolhas (3x)\n- Visite Eco-Zero 10x para companheiro!');
        }

        function showCredits() {
            showNotification('CHRONOS ECHO\nParte 1: O Despertar\n\nPersonagens:\n- Eco-Zero: O Eco Quebrado\n- Aldric III: O Morto-Vivo\n- Kael: O Herdeiro de Cinzas\n- Seraphina: A Vi√∫va de Gelo');
        }

        // Auto-save
        setInterval(saveGame, 30000);

        // Teclas
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeDialogue();
            if (e.key === 'F5') { e.preventDefault(); saveGame(); showNotification('Salvo!'); }
            if (e.key === 'F9') { e.preventDefault(); loadGame(); }
        });

        console.log('CHRONOS ECHO carregado');
    </script>
</body>
</html>
